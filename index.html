<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>è‡´ç‹é™†æ´ - æˆ‘çš„å¿ƒæ„</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ä¿æŒåŸæœ‰çš„CSSæ ·å¼ï¼Œåªä¿®æ”¹å¿…è¦çš„éƒ¨åˆ† */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-text-size-adjust: 100%;
            -moz-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow-x: hidden;
            position: relative;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(-45deg, #ff6b9d, #ff8fab, #ffb3c6, #ffccd5);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            color: #333;
            min-height: 100vh;
            overflow-y: auto !important;
            -webkit-overflow-scrolling: touch !important;
            touch-action: pan-y pinch-zoom;
        }
        
        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* ä¸»å®¹å™¨ */
        .container {
            width: 95%;
            max-width: 600px;
            margin: 20px auto 40px;
            background: rgba(255, 255, 255, 0.97);
            border-radius: 25px;
            padding: 25px 20px;
            box-shadow: 0 10px 40px rgba(255, 107, 157, 0.2);
            position: relative;
            z-index: 2;
        }
        
        /* éŸ³ä¹æ§åˆ¶åŒºåŸŸ - æ›´æ˜¾çœ¼ */
        .music-control-area {
            background: rgba(255, 107, 157, 0.1);
            border-radius: 15px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
            border: 2px solid #ff8fab;
        }
        
        .music-control-area h4 {
            color: #ff6b9d;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }
        
        .music-control {
            background: white;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            border: 2px solid #ff6b9d;
            box-shadow: 0 3px 10px rgba(255, 107, 157, 0.2);
            margin: 0 auto;
            transition: all 0.3s;
        }
        
        .music-control:active {
            transform: scale(0.95);
        }
        
        .music-control i {
            font-size: 1.3rem;
            color: #ff6b9d;
        }
        
        .music-status {
            font-size: 0.9rem;
            color: #ff8fab;
            margin-top: 10px;
            min-height: 20px;
        }
        
        /* è¡¨ç™½å¯¹è±¡åŒºåŸŸ */
        #beloved-person {
            padding: 20px 15px;
            background: linear-gradient(135deg, rgba(255, 107, 157, 0.1), rgba(255, 182, 193, 0.1));
            border-radius: 20px;
            margin: 20px 0;
            border: 2px solid #ff8fab;
            text-align: center;
        }
        
        #beloved-person h3 {
            font-size: 2rem;
            color: #ff6b9d;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        /* æŒ‰é’®åŒºåŸŸ */
        .buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 25px 0;
        }
        
        .btn {
            padding: 18px 25px;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            width: 100%;
            min-height: 56px;
        }
        
        .btn:active {
            transform: scale(0.98);
        }
        
        .yes-btn {
            background: linear-gradient(135deg, #ff6b9d, #ff8fab);
            color: white;
            box-shadow: 0 5px 15px rgba(255, 107, 157, 0.3);
        }
        
        .no-btn {
            background: rgba(255, 107, 157, 0.1);
            color: #ff6b9d;
            border: 2px solid #ff8fab;
        }
        
        /* æˆåŠŸé¡µé¢ */
        .success {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .success-content {
            background: white;
            border-radius: 25px;
            padding: 30px 25px;
            max-width: 90%;
            text-align: center;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        
        /* å“åº”å¼ */
        @media (min-width: 768px) {
            .container {
                margin: 40px auto;
                padding: 35px 30px;
            }
            
            .buttons {
                flex-direction: row;
            }
            
            .btn {
                width: auto;
                flex: 1;
            }
        }
        
        /* å…¶ä»–æ ·å¼ä¿æŒä¸å˜... */
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-heart heart-icon"></i> è‡´ç‹é™†æ´ <i class="fas fa-heart heart-icon"></i></h1>
            <h2>ä¸€å°ç‰¹åˆ«çš„å‘Šç™½ä¿¡</h2>
        </div>
        
        <!-- éŸ³ä¹æ§åˆ¶åŒºåŸŸ -->
        <div class="music-control-area">
            <h4>ğŸµ è¯·å…ˆç‚¹å‡»æ’­æ”¾éŸ³ä¹ ğŸµ</h4>
            <div class="music-control" id="music-control">
                <i class="fas fa-play" id="music-icon"></i>
            </div>
            <div class="music-status" id="music-status">
                ç‚¹å‡»æ’­æ”¾æŒ‰é’®å¼€å§‹æµªæ¼«éŸ³ä¹
            </div>
        </div>
        
        <!-- è¡¨ç™½å¯¹è±¡åŒºåŸŸ -->
        <div id="beloved-person">
            <h3>ç»™äº²çˆ±çš„ç‹é™†æ´</h3>
            <p>è¿™ä»½å¿ƒæ„æ˜¯ä¸“é—¨ä¸ºä½ å‡†å¤‡çš„ â¤ï¸</p>
        </div>
        
        <div class="love-letter" id="love-letter">
            <p>äº²çˆ±çš„ç‹é™†æ´ï¼š</p>
            <p>é‡è§ä½ ï¼Œæ˜¯æˆ‘ç”Ÿå‘½ä¸­æœ€ç¾å¥½çš„æ„å¤–ã€‚ä½ çš„ç¬‘å®¹æ€»èƒ½ç…§äº®æˆ‘çš„ä¸€å¤©ï¼Œä½ çš„å£°éŸ³æ˜¯æˆ‘æœ€æƒ³å¬è§çš„æ—‹å¾‹ã€‚</p>
            <p>å’Œä½ åœ¨ä¸€èµ·çš„æ¯ä¸€åˆ»éƒ½è®©æˆ‘æ„Ÿåˆ°æ— æ¯”å¹¸ç¦å’Œå®‰å¿ƒã€‚æˆ‘å–œæ¬¢çœ‹ä½ ä¸“æ³¨çš„æ ·å­ï¼Œå–œæ¬¢å¬ä½ åˆ†äº«ç”Ÿæ´»ä¸­çš„ç‚¹æ»´ï¼Œå–œæ¬¢æ‰€æœ‰å…³äºä½ çš„ä¸€åˆ‡ã€‚</p>
            <p>æˆ–è®¸æˆ‘ä¸æ“…é•¿ç”¨åä¸½çš„è¯è—»è¡¨è¾¾æ„Ÿæƒ…ï¼Œä½†æˆ‘çš„æ¯ä¸€ä»½å¿ƒæ„éƒ½æ˜¯çœŸæŒšçš„ã€‚æˆ‘æƒ³é™ªä½ åº¦è¿‡æ¯ä¸€ä¸ªå¹³å‡¡è€Œåˆç‰¹åˆ«çš„æ—¥å­ï¼Œåˆ†äº«ä½ çš„å–œæ€’å“€ä¹ã€‚</p>
            <p>ä»Šå¤©ï¼Œæˆ‘æƒ³å¯¹ä½ è¯´ï¼šæˆ‘å–œæ¬¢ä½ ï¼Œç‹é™†æ´ï¼è¿™ä»½å–œæ¬¢ä¸æ˜¯ä¸€æ—¶çš„å†²åŠ¨ï¼Œè€Œæ˜¯ç»è¿‡æ—¶é—´æ²‰æ·€çš„çœŸæŒšæƒ…æ„Ÿã€‚</p>
            <p>ä½ æ„¿æ„ç»™æˆ‘ä¸€ä¸ªæœºä¼šï¼Œè®©æˆ‘èµ°è¿›ä½ çš„ä¸–ç•Œï¼Œæˆä¸ºé‚£ä¸ªå¯ä»¥å®ˆæŠ¤ä½ ã€é™ªä¼´ä½ çš„äººå—ï¼Ÿ</p>
            <p style="text-align: right; margin-top: 25px; font-weight: 600;">
                â€”â€” ä¸€ç›´é»˜é»˜å…³æ³¨ç€ä½ çš„äºº<br>
                <span style="font-size: 0.9rem; color: #ff6b9d;">â¤ï¸</span>
            </p>
        </div>
        
        <div class="buttons">
            <button class="btn yes-btn" id="yes-btn">
                <i class="fas fa-heart"></i> æˆ‘æ„¿æ„
            </button>
            <button class="btn no-btn" id="no-btn">
                <i class="fas fa-smile"></i> è®©æˆ‘æƒ³æƒ³
            </button>
        </div>
        
        <div class="footer">
            <p><i class="far fa-heart"></i> ç”¨å¿ƒåˆ¶ä½œçš„è¡¨ç™½é¡µé¢ <i class="far fa-heart"></i></p>
            <p style="font-size: 0.8rem; margin-top: 5px; color: #ff6b9d;">ğŸ’¡ æç¤ºï¼šè¯·å…ˆç‚¹å‡»æ’­æ”¾éŸ³ä¹ï¼Œå†æµè§ˆå†…å®¹</p>
        </div>
    </div>
    
    <!-- æˆåŠŸé¡µé¢ -->
    <div class="success" id="success">
        <div class="success-content">
            <h1>â¤ï¸ å¤ªæ£’äº†ï¼ â¤ï¸</h1>
            <p>è°¢è°¢ä½ ï¼Œç‹é™†æ´ï¼<br>ä½ è®©æˆ‘çš„ä¸–ç•Œå˜å¾—æ›´åŠ ç¾å¥½ã€‚<br>æˆ‘ä¼šçæƒœè¿™ä»½ç¼˜åˆ†ï¼Œç”¨å¿ƒå¯¹å¾…æˆ‘ä»¬çš„æ„Ÿæƒ…ã€‚</p>
            <button class="close-btn" id="close-btn">ç»§ç»­æµªæ¼«ä¹‹æ—…</button>
        </div>
    </div>
    
    <!-- èƒŒæ™¯éŸ³ä¹ - ä½¿ç”¨å¤šä¸ªå¯é çš„éŸ³ä¹æº -->
    <audio id="bg-music" loop preload="metadata" style="display: none;">
        <!-- å¤šä¸ªéŸ³ä¹æºï¼ŒæŒ‰ä¼˜å…ˆçº§æ’åˆ— -->
        <source src="https://cdn.jsdelivr.net/gh/zhixiangtang/audio@main/music/love.mp3" type="audio/mpeg" id="music-source-1">
        <source src="https://assets.mixkit.co/music/preview/mixkit-romantic-sunset-687.mp3" type="audio/mpeg" id="music-source-2">
        <source src="https://assets.mixkit.co/music/preview/mixkit-valentines-day-493.mp3" type="audio/mpeg" id="music-source-3">
        <source src="https://assets.mixkit.co/music/preview/mixkit-a-very-happy-christmas-897.mp3" type="audio/mpeg" id="music-source-4">
        <source src="https://cdn.pixabay.com/download/audio/2022/03/10/audio_ecb98f6b28.mp3" type="audio/mpeg" id="music-source-5">
        æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒéŸ³é¢‘æ’­æ”¾
    </audio>
    
    <script>
        // ä¿®å¤éŸ³ä¹æ’­æ”¾é—®é¢˜
        document.addEventListener('DOMContentLoaded', function() {
            console.log('é¡µé¢åŠ è½½å®Œæˆ');
            
            // åˆå§‹åŒ–éŸ³ä¹æ’­æ”¾å™¨
            initMusicPlayer();
            
            // ç»‘å®šå…¶ä»–äº‹ä»¶
            bindEvents();
            
            // æ·»åŠ ç”¨æˆ·äº¤äº’æç¤º
            showMusicTip();
        });
        
        function initMusicPlayer() {
            const bgMusic = document.getElementById('bg-music');
            const musicControl = document.getElementById('music-control');
            const musicIcon = document.getElementById('music-icon');
            const musicStatus = document.getElementById('music-status');
            
            // è®¾ç½®åˆå§‹çŠ¶æ€
            let isPlaying = false;
            bgMusic.volume = 0.4; // é€‚ä¸­éŸ³é‡
            
            // å°è¯•é¢„åŠ è½½éŸ³ä¹
            bgMusic.load();
            
            // éŸ³ä¹æ§åˆ¶ç‚¹å‡»äº‹ä»¶
            musicControl.addEventListener('click', function(e) {
                e.stopPropagation();
                
                if (isPlaying) {
                    // æš‚åœéŸ³ä¹
                    bgMusic.pause();
                    isPlaying = false;
                    musicIcon.className = 'fas fa-play';
                    musicStatus.innerHTML = 'éŸ³ä¹å·²æš‚åœ';
                    musicStatus.style.color = '#ff8fab';
                } else {
                    // æ’­æ”¾éŸ³ä¹ - å¤„ç†å¯èƒ½çš„é”™è¯¯
                    const playPromise = bgMusic.play();
                    
                    if (playPromise !== undefined) {
                        playPromise.then(() => {
                            // æ’­æ”¾æˆåŠŸ
                            isPlaying = true;
                            musicIcon.className = 'fas fa-pause';
                            musicStatus.innerHTML = 'éŸ³ä¹æ’­æ”¾ä¸­...';
                            musicStatus.style.color = '#ff6b9d';
                            console.log('éŸ³ä¹æ’­æ”¾æˆåŠŸ');
                        }).catch(error => {
                            // æ’­æ”¾å¤±è´¥
                            console.error('éŸ³ä¹æ’­æ”¾å¤±è´¥:', error);
                            musicStatus.innerHTML = 'âŒ æ’­æ”¾å¤±è´¥ï¼Œè¯·ç‚¹å‡»é¡µé¢ä»»æ„ä½ç½®åé‡è¯•';
                            musicStatus.style.color = '#ff4757';
                            
                            // å°è¯•åˆ‡æ¢éŸ³ä¹æº
                            retryWithAlternateSource();
                        });
                    }
                }
            });
            
            // éŸ³ä¹åŠ è½½é”™è¯¯å¤„ç†
            bgMusic.addEventListener('error', function(e) {
                console.error('éŸ³ä¹åŠ è½½é”™è¯¯:', e);
                musicStatus.innerHTML = 'âš ï¸ æ­£åœ¨å°è¯•å¤‡ç”¨éŸ³ä¹æº...';
                
                // è‡ªåŠ¨å°è¯•ä¸‹ä¸€ä¸ªéŸ³ä¹æº
                retryWithAlternateSource();
            });
            
            // éŸ³ä¹æ’­æ”¾ç»“æŸ
            bgMusic.addEventListener('ended', function() {
                console.log('éŸ³ä¹æ’­æ”¾ç»“æŸ');
                musicStatus.innerHTML = 'éŸ³ä¹æ’­æ”¾ç»“æŸ';
            });
            
            // å°è¯•å¤‡ç”¨éŸ³ä¹æº
            function retryWithAlternateSource() {
                const currentSource = bgMusic.currentSrc;
                const sources = [
                    'https://cdn.jsdelivr.net/gh/zhixiangtang/audio@main/music/love.mp3',
                    'https://assets.mixkit.co/music/preview/mixkit-romantic-sunset-687.mp3',
                    'https://assets.mixkit.co/music/preview/mixkit-valentines-day-493.mp3',
                    'https://assets.mixkit.co/music/preview/mixkit-a-very-happy-christmas-897.mp3'
                ];
                
                // æ‰¾åˆ°å½“å‰æºåœ¨åˆ—è¡¨ä¸­çš„ä½ç½®
                let currentIndex = sources.findIndex(src => currentSource.includes(src));
                
                // å°è¯•ä¸‹ä¸€ä¸ªæº
                const nextIndex = (currentIndex + 1) % sources.length;
                const nextSource = sources[nextIndex];
                
                console.log(`å°è¯•åˆ‡æ¢åˆ°éŸ³ä¹æº ${nextIndex + 1}: ${nextSource}`);
                
                // åˆ‡æ¢éŸ³ä¹æº
                bgMusic.src = nextSource;
                bgMusic.load();
                
                // å¦‚æœæ˜¯æ’­æ”¾çŠ¶æ€ï¼Œè‡ªåŠ¨æ’­æ”¾
                if (isPlaying) {
                    setTimeout(() => {
                        bgMusic.play().catch(e => {
                            console.log('å¤‡ç”¨æºæ’­æ”¾å¤±è´¥ï¼Œç»§ç»­å°è¯•ä¸‹ä¸€ä¸ª');
                        });
                    }, 500);
                }
            }
            
            // éŸ³é‡æ§åˆ¶ï¼ˆå¯é€‰ï¼‰
            bgMusic.addEventListener('volumechange', function() {
                console.log('éŸ³é‡:', bgMusic.volume);
            });
            
            // ä¸ºäº†è®©éŸ³ä¹èƒ½åœ¨ç§»åŠ¨ç«¯æ’­æ”¾ï¼Œéœ€è¦ç”¨æˆ·å…ˆä¸é¡µé¢äº¤äº’
            document.addEventListener('click', function firstInteraction() {
                // é¢„åŠ è½½éŸ³ä¹ä½†ä¸è‡ªåŠ¨æ’­æ”¾
                bgMusic.load();
                document.removeEventListener('click', firstInteraction);
            });
        }
        
        function bindEvents() {
            const yesBtn = document.getElementById('yes-btn');
            const noBtn = document.getElementById('no-btn');
            const closeBtn = document.getElementById('close-btn');
            const successPage = document.getElementById('success');
            
            // æˆ‘æ„¿æ„æŒ‰é’®
            yesBtn.addEventListener('click', function() {
                successPage.style.display = 'flex';
                createCelebration();
            });
            
            // è®©æˆ‘æƒ³æƒ³æŒ‰é’®
            noBtn.addEventListener('click', function() {
                const maxX = window.innerWidth - this.offsetWidth - 20;
                const maxY = window.innerHeight - this.offsetHeight - 20;
                
                const x = Math.max(20, Math.random() * maxX);
                const y = Math.max(20, Math.random() * maxY);
                
                this.style.position = 'fixed';
                this.style.left = `${x}px`;
                this.style.top = `${y}px`;
                this.style.zIndex = '1001';
                
                const messages = ["å†ç»™æˆ‘ä¸€æ¬¡æœºä¼š", "æˆ‘çœŸçš„å¾ˆè®¤çœŸ", "ä¸è¦æ‹’ç»å˜›", "è€ƒè™‘ä¸€ä¸‹æˆ‘", "æˆ‘ä¼šä¸€ç›´ç­‰ä½ "];
                const randomMessage = messages[Math.floor(Math.random() * messages.length)];
                this.innerHTML = `<i class="fas fa-smile"></i> ${randomMessage}`;
            });
            
            // å…³é—­æˆåŠŸé¡µé¢
            closeBtn.addEventListener('click', function() {
                successPage.style.display = 'none';
            });
        }
        
        function showMusicTip() {
            const musicStatus = document.getElementById('music-status');
            
            // 3ç§’åæ˜¾ç¤ºæç¤º
            setTimeout(() => {
                if (musicStatus.innerHTML.includes('ç‚¹å‡»æ’­æ”¾æŒ‰é’®')) {
                    musicStatus.innerHTML = 'ğŸ’¡ æç¤ºï¼šç‚¹å‡»ä¸Šæ–¹çš„æ’­æ”¾æŒ‰é’®å¼€å§‹éŸ³ä¹';
                }
            }, 3000);
        }
        
        function createCelebration() {
            const colors = ['#ff6b9d', '#ff8fab', '#ffb3c6', '#ffffff'];
            
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const firework = document.createElement('div');
                    firework.style.cssText = `
                        position: fixed;
                        width: 8px;
                        height: 8px;
                        border-radius: 50%;
                        background: ${colors[Math.floor(Math.random() * colors.length)]};
                        left: ${Math.random() * 100}vw;
                        top: ${Math.random() * 100}vh;
                        z-index: 1001;
                        pointer-events: none;
                    `;
                    
                    document.body.appendChild(firework);
                    
                    firework.animate([
                        { transform: 'scale(0)', opacity: 1 },
                        { transform: 'scale(2)', opacity: 0 }
                    ], {
                        duration: 800,
                        easing: 'ease-out'
                    });
                    
                    setTimeout(() => firework.remove(), 800);
                }, i * 100);
            }
        }
        
        // ç¡®ä¿é¡µé¢å¯ä»¥æ»šåŠ¨
        window.addEventListener('load', function() {
            document.body.style.minHeight = Math.max(document.body.scrollHeight, window.innerHeight) + 'px';
        });
    </script>
</body>
</html>
